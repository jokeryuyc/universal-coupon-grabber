# Universal Coupon Grabber - ä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…æ’ä»¶

1. **ä¸‹è½½é¡¹ç›®**
   ```bash
   git clone https://github.com/jokeryuyc/universal-coupon-grabber.git
   ```

2. **åŠ è½½åˆ°Chrome**
   - æ‰“å¼€ `chrome://extensions/`
   - å¼€å¯"å¼€å‘è€…æ¨¡å¼"
   - ç‚¹å‡»"åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº"
   - é€‰æ‹© `universal-coupon-grabber` æ–‡ä»¶å¤¹

3. **éªŒè¯å®‰è£…**
   - æµè§ˆå™¨å·¥å…·æ å‡ºç°æ’ä»¶å›¾æ ‡
   - ç‚¹å‡»å›¾æ ‡æ‰“å¼€å¼¹çª—ç•Œé¢

### 2. åŸºæœ¬ä½¿ç”¨æµç¨‹

#### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨å‘ç°æ¨¡å¼ï¼ˆæ¨èï¼‰

**é€‚ç”¨åœºæ™¯**: ç¾å›¢ã€æ·˜å®ç­‰å·²é€‚é…ç½‘ç«™çš„æŠ¢åˆ¸æ´»åŠ¨

1. **è®¿é—®ç›®æ ‡ç½‘ç«™**
   ```
   ä¾‹å¦‚ï¼šhttps://i.meituan.com/promotion/seckill
   ```

2. **å¯åŠ¨ç›‘å¬**
   - ç‚¹å‡»æ’ä»¶å›¾æ ‡
   - ç‚¹å‡»"å¼€å§‹æ•è·"æŒ‰é’®
   - çŠ¶æ€æ˜¾ç¤ºä¸º"ç›‘å¬ä¸­"

3. **è§¦å‘å‘ç°**
   - æ­£å¸¸æµè§ˆæŠ¢åˆ¸é¡µé¢
   - ç‚¹å‡»"ç«‹å³æŠ¢è´­"ç­‰æŒ‰é’®
   - æ’ä»¶è‡ªåŠ¨è¯†åˆ«APIè¯·æ±‚

4. **ç¡®è®¤ä»»åŠ¡**
   - æ’ä»¶å¼¹å‡º"å‘ç°æ–°ä»»åŠ¡"æç¤º
   - æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…å’Œç½®ä¿¡åº¦
   - ç‚¹å‡»"åˆ›å»ºä»»åŠ¡"

5. **é…ç½®æ‰§è¡Œ**
   - è®¾ç½®ä»»åŠ¡åç§°
   - é€‰æ‹©æ‰§è¡Œæ—¶é—´
   - è°ƒæ•´é‡è¯•å‚æ•°
   - ç‚¹å‡»"ä¿å­˜"

6. **ç­‰å¾…æ‰§è¡Œ**
   - ä»»åŠ¡è‡ªåŠ¨åœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œ
   - å®æ—¶æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—

#### æ–¹å¼äºŒï¼šæ‰‹åŠ¨åˆ›å»ºæ¨¡å¼

**é€‚ç”¨åœºæ™¯**: æœªé€‚é…ç½‘ç«™æˆ–éœ€è¦ç²¾ç¡®æ§åˆ¶çš„åœºæ™¯

1. **æŠ“å–è¯·æ±‚**
   - æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·
   - åˆ‡æ¢åˆ°Networkæ ‡ç­¾
   - æ‰§è¡Œä¸€æ¬¡æŠ¢åˆ¸æ“ä½œ
   - æ‰¾åˆ°å…³é”®çš„POSTè¯·æ±‚
   - å³é”®é€‰æ‹©"Copy as cURL"

2. **åˆ›å»ºä»»åŠ¡**
   - ç‚¹å‡»æ’ä»¶çš„"æ–°å»ºä»»åŠ¡"
   - æˆ–ç‚¹å‡»"å¯¼å…¥ä»»åŠ¡"ç²˜è´´cURL

3. **é…ç½®å‚æ•°**
   ```json
   {
     "name": "æ·˜å®èšåˆ’ç®—ç§’æ€",
     "url": "https://mtop.taobao.com/h5/mtop.ju.seckill.order.submit/",
     "method": "POST",
     "executeAt": "2024-01-01T12:00:00.000Z",
     "maxAttempts": 10,
     "intervalMs": 100
   }
   ```

4. **æµ‹è¯•éªŒè¯**
   - ç‚¹å‡»"æµ‹è¯•"æŒ‰é’®
   - æ£€æŸ¥å“åº”ç»“æœ
   - ç¡®è®¤é…ç½®æ­£ç¡®

5. **å¯åŠ¨ä»»åŠ¡**
   - ç‚¹å‡»"ä¿å­˜"
   - ä»»åŠ¡è¿›å…¥è°ƒåº¦é˜Ÿåˆ—

## ğŸ¯ ç½‘ç«™é€‚é…è¯´æ˜

### å·²æ”¯æŒç½‘ç«™

| ç½‘ç«™ | åŸŸå | æ”¯æŒåŠŸèƒ½ | ç­¾åæœºåˆ¶ |
|------|------|----------|----------|
| ç¾å›¢ | meituan.com | ç§’æ€åˆ¸ã€é—ªè´­ã€å›¢è´­ | H5guard |
| æ·˜å® | taobao.com | èšåˆ’ç®—ã€ä¼˜æƒ åˆ¸ | mtop |
| å¤©çŒ« | tmall.com | ä¼˜æƒ åˆ¸ã€ç›´æ’­åˆ¸ | mtop |

### ç¾å›¢ç½‘ç«™ä½¿ç”¨

**ç‰¹ç‚¹**: éœ€è¦H5guardç­¾åï¼Œæ’ä»¶è‡ªåŠ¨å¤„ç†

**å¸¸è§APIæ¨¡å¼**:
```
/promotion/seckill/couponcomponent/grabcoupon  # ç§’æ€åˆ¸
/promotion/seckill/ordercomponent/submit       # é—ªè´­ä¸‹å•
/group/v4/deal/commit                          # å›¢è´­ä¸‹å•
```

**ä½¿ç”¨æ­¥éª¤**:
1. è®¿é—®ç¾å›¢æŠ¢åˆ¸é¡µé¢
2. å¼€å¯æ’ä»¶ç›‘å¬
3. ç‚¹å‡»æŠ¢åˆ¸æŒ‰é’®è§¦å‘å‘ç°
4. é…ç½®æ‰§è¡Œæ—¶é—´å¹¶ä¿å­˜

### æ·˜å®/å¤©çŒ«ä½¿ç”¨

**ç‰¹ç‚¹**: ä½¿ç”¨mtopç­¾åæœºåˆ¶

**å¸¸è§APIæ¨¡å¼**:
```
/mtop.ju.seckill.order.submit      # èšåˆ’ç®—ç§’æ€
/mtop.marketing.coupon.get         # ä¼˜æƒ åˆ¸é¢†å–
/mtop.taobao.live.coupon.get       # ç›´æ’­é—´ä¼˜æƒ åˆ¸
```

**æ³¨æ„äº‹é¡¹**:
- éœ€è¦ç™»å½•çŠ¶æ€
- æŸäº›æ´»åŠ¨éœ€è¦ç‰¹å®šçš„token

## âš™ï¸ é«˜çº§é…ç½®

### ä»»åŠ¡é…ç½®è¯¦è§£

```json
{
  "name": "ä»»åŠ¡åç§°",
  "type": "scheduled",           // immediate, scheduled, recurring
  "request": {
    "url": "https://api.example.com/grab",
    "method": "POST",
    "headers": {
      "Content-Type": "application/json",
      "User-Agent": "Mozilla/5.0..."
    },
    "body": {
      "activityId": "12345",
      "couponId": "67890"
    }
  },
  "schedule": {
    "executeAt": "2024-01-01T12:00:00.000Z",
    "timezone": "Asia/Shanghai",
    "advanceMs": 500              // æå‰é‡
  },
  "execution": {
    "maxAttempts": 10,            // æœ€å¤§å°è¯•æ¬¡æ•°
    "intervalMs": 100,            // é‡è¯•é—´éš”
    "timeoutMs": 5000,            // è¯·æ±‚è¶…æ—¶
    "concurrency": 1              // å¹¶å‘æ•°
  },
  "successCondition": {
    "type": "response_contains",   // æˆåŠŸæ¡ä»¶ç±»å‹
    "value": "success"            // æœŸæœ›å€¼
  }
}
```

### æˆåŠŸæ¡ä»¶ç±»å‹

1. **status_code**: HTTPçŠ¶æ€ç 
   ```json
   {"type": "status_code", "value": 200}
   ```

2. **response_contains**: å“åº”åŒ…å«æ–‡æœ¬
   ```json
   {"type": "response_contains", "value": "æŠ¢è´­æˆåŠŸ"}
   ```

3. **response_json_path**: JSONè·¯å¾„åŒ¹é…
   ```json
   {"type": "response_json_path", "path": "data.success", "value": true}
   ```

4. **custom**: è‡ªå®šä¹‰JavaScriptè¡¨è¾¾å¼
   ```json
   {"type": "custom", "expression": "statusCode === 200 && responseText.includes('success')"}
   ```

### ç½‘ç«™è§„åˆ™é…ç½®

åˆ›å»º `rules/example.com.json`:

```json
{
  "website": "example.com",
  "name": "ç¤ºä¾‹ç½‘ç«™",
  "capturePatterns": [
    {
      "name": "coupon_grab",
      "urlPattern": "/api/coupon/grab",
      "method": "POST",
      "priority": 0.9
    }
  ],
  "signatureConfig": {
    "type": "custom",
    "required": false
  },
  "successConditions": [
    {
      "type": "response_contains",
      "value": "success",
      "weight": 1.0
    }
  ],
  "failureConditions": [
    {
      "type": "response_contains",
      "value": "å·²æŠ¢å®Œ",
      "action": "stop"
    }
  ]
}
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ’ä»¶æ— æ³•åŠ è½½**
   - æ£€æŸ¥Chromeç‰ˆæœ¬ï¼ˆéœ€è¦88+ï¼‰
   - ç¡®è®¤å¼€å¯å¼€å‘è€…æ¨¡å¼
   - æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

2. **ç½‘ç»œç›‘å¬ä¸å·¥ä½œ**
   - åˆ·æ–°é¡µé¢é‡è¯•
   - æ£€æŸ¥ç½‘ç«™æ˜¯å¦æ”¯æŒ
   - æŸ¥çœ‹content scriptæ˜¯å¦æ³¨å…¥æˆåŠŸ

3. **ç­¾åå¤±è´¥**
   - ç¡®è®¤ç½‘ç«™å·²åŠ è½½å®Œæˆ
   - æ£€æŸ¥H5guardç­‰å¯¹è±¡æ˜¯å¦å­˜åœ¨
   - å°è¯•æ‰‹åŠ¨åˆ·æ–°é¡µé¢

4. **ä»»åŠ¡ä¸æ‰§è¡Œ**
   - æ£€æŸ¥æ‰§è¡Œæ—¶é—´è®¾ç½®
   - ç¡®è®¤ä»»åŠ¡çŠ¶æ€ä¸º"è¿è¡Œä¸­"
   - æŸ¥çœ‹backgroundé¡µé¢çš„é”™è¯¯æ—¥å¿—

5. **è¯·æ±‚è¢«æ‹’ç»**
   - æ£€æŸ¥è¯·æ±‚å¤´å’Œå‚æ•°
   - ç¡®è®¤ç™»å½•çŠ¶æ€
   - éªŒè¯ç­¾åæ˜¯å¦æ­£ç¡®

### è°ƒè¯•æ–¹æ³•

1. **å¼€å¯è°ƒè¯•æ¨¡å¼**
   - è¿›å…¥æ’ä»¶è®¾ç½®
   - å¯ç”¨"è°ƒè¯•æ¨¡å¼"
   - æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

2. **æŸ¥çœ‹æ§åˆ¶å°**
   ```javascript
   // åœ¨é¡µé¢æ§åˆ¶å°æ‰§è¡Œ
   console.log(window.H5guard);  // æ£€æŸ¥ç­¾åå¯¹è±¡
   console.log(window.networkMonitor);  // æ£€æŸ¥ç›‘å¬å™¨
   ```

3. **æ£€æŸ¥å­˜å‚¨æ•°æ®**
   ```javascript
   // åœ¨backgroundé¡µé¢æ§åˆ¶å°æ‰§è¡Œ
   chrome.storage.local.get(null, console.log);
   ```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### æé«˜æˆåŠŸç‡

1. **æ—¶é—´åŒæ­¥**
   - å¯ç”¨è‡ªåŠ¨æ—¶é—´åŒæ­¥
   - æ‰‹åŠ¨æ ¡å‡†æ—¶é—´åå·®
   - è°ƒæ•´æå‰é‡å‚æ•°

2. **ç½‘ç»œä¼˜åŒ–**
   - ä½¿ç”¨ç¨³å®šçš„ç½‘ç»œè¿æ¥
   - å…³é—­å…¶ä»–å ç”¨å¸¦å®½çš„åº”ç”¨
   - è€ƒè™‘ä½¿ç”¨ä»£ç†æœåŠ¡å™¨

3. **å‚æ•°è°ƒä¼˜**
   - å¢åŠ é‡è¯•æ¬¡æ•°
   - å‡å°‘é‡è¯•é—´éš”
   - å¯ç”¨å¹¶å‘æ‰§è¡Œ

### å‡å°‘èµ„æºå ç”¨

1. **é™åˆ¶æ—¥å¿—æ•°é‡**
   - è®¾ç½®åˆç†çš„æ—¥å¿—ä¸Šé™
   - å®šæœŸæ¸…ç†å†å²è®°å½•

2. **ä¼˜åŒ–ç›‘å¬èŒƒå›´**
   - åªåœ¨éœ€è¦æ—¶å¯ç”¨ç›‘å¬
   - ä½¿ç”¨ç²¾ç¡®çš„URLæ¨¡å¼

## ğŸ›¡ï¸ å®‰å…¨å»ºè®®

1. **åˆè§„ä½¿ç”¨**
   - éµå®ˆç½‘ç«™æœåŠ¡æ¡æ¬¾
   - ä¸è¦è¿‡åº¦é¢‘ç¹è¯·æ±‚
   - å°Šé‡ç½‘ç«™çš„åçˆ¬è™«æœºåˆ¶

2. **æ•°æ®å®‰å…¨**
   - å®šæœŸå¤‡ä»½ä»»åŠ¡é…ç½®
   - ä¸è¦åˆ†äº«åŒ…å«æ•æ„Ÿä¿¡æ¯çš„é…ç½®
   - åŠæ—¶æ›´æ–°æ’ä»¶ç‰ˆæœ¬

3. **éšç§ä¿æŠ¤**
   - æ’ä»¶ä¸ä¼šä¸Šä¼ ä»»ä½•æ•°æ®
   - æ‰€æœ‰ä¿¡æ¯å­˜å‚¨åœ¨æœ¬åœ°
   - å¯éšæ—¶æ¸…ç©ºæ•°æ®

## ğŸ“ è·å–å¸®åŠ©

- **GitHub Issues**: https://github.com/jokeryuyc/universal-coupon-grabber/issues
- **é¡¹ç›®ä¸»é¡µ**: https://github.com/jokeryuyc/universal-coupon-grabber
- **Wikiæ–‡æ¡£**: https://github.com/jokeryuyc/universal-coupon-grabber/wiki
- **ç¤¾åŒºè®¨è®º**: ä½¿ç”¨ç»éªŒåˆ†äº«

è®°ä½ï¼šæœ¬å·¥å…·ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨ï¼Œè¯·åˆç†åˆæ³•ä½¿ç”¨ï¼
